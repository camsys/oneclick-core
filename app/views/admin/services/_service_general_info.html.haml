=content_for :header do
  General Info
  =render partial: "shared/published_badge", locals: {object: @service}

=simple_form_for @service,
  url: admin_service_path, remote: true, authenticity_token: true, data: {type: 'html'},
  html: {class: 'form-horizontal', id: form_id_from_path, multipart: true, method: :put } do |f|
  =remote_form_input # This sends the partial_path to the controller, so it can serve back the correct partial

  =f.input :name
  =logo_upload_input(f)
  =f.input :url
  =f.input :phone
  =f.input :email
  -if can? :manage, Service  # Only show agency menu if the user can manage services
    =f.association :agency,
      label: 'Transportation Agency',
      include_blank: "Select a Transit Agency",
      selected: @service.agency&.id,
      collection: TransportationAgency.where(id:current_user.accessible_agencies.pluck(:id))
  =simple_form_for :oversight do |foa|
    -# If they're a superuser, show all oversight agencies
    - if current_user.superuser?
      = foa.input :oversight_agency_id,
        required: true,
        collection: OversightAgency.all,
        label_method: :name,
        value_method: :id,
        selected: @service.service_oversight_agency.oversight_agency.id,
        wrapper_html: {id: 'oversight_select'}
    - if current_user.staff_agency&.type == "TransportationAgency"
      = foa.input :oversight_agency_id,
          collection: [@service.service_oversight_agency.oversight_agency],
          readonly:true,
          include_blank: false,
          label_method: :name,
          value_method: :id,
          selected: @service.service_oversight_agency.oversight_agency.id,
          wrapper_html: {id: 'oversight_select'}
    - if current_user.staff_agency&.type == "OversightAgency" && current_user.admin?
      = foa.input :oversight_agency_id,
          collection: [@service.service_oversight_agency.oversight_agency],
          readonly:true,
          include_blank: false,
          label_method: :name,
          value_method: :id,
          selected: @service.service_oversight_agency.oversight_agency.id,
          wrapper_html: {id: 'oversight_select'}

:javascript
  $(document).ready(function() {
    new FormHandler($('#{form_selector_from_id}'));
  });
